<!DOCTYPE html>
<!-- saved from url=(0116)https://script.google.com/macros/s/AKfycbxsyGVm8ANjGPhqO34QdNXYp7K02O9_iy-%2D42Wjx_ptG9-Xr-hp9MRc0WizQ9bR_aX-8w/exec -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="chromevox" content-script="no">
<title>Cuestionario Dinámico</title>
<link rel="stylesheet" href="./CuestionarioIC2_files/icon" nonce=""><link rel="stylesheet" href="./CuestionarioIC2_files/2107809627-mae_html_css_ltr.css">
<script type="text/javascript" src="./CuestionarioIC2_files/2796903041-warden_bin_i18n_warden.js.descarga" nonce=""></script>
</head>
<body>
<table id="warning-bar-table" class="full_size" cellspacing="0" cellpadding="0"><tbody><tr><td><div id="warning" class="warning-bar warning-banner-bar" role="banner" aria-live="assertive" aria-labelledby="warning-text"><div class="warning-banner"><div class="warning-banner-header"><span class="warning-banner-icon"><svg aria-hidden="true" viewbox="0 0 24 24" width="24px" height="24px"><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></svg></span><div class="warning-banner-text" id="warning-text" role="alert">This application was created by a Google Apps Script user</div></div><div class="warning-banner-buttons"><a class="warning-link" href="https://developers.google.com/apps-script" target="_blank">Learn more</a></div></div><div class="warning-banner-close-icon" tabindex="0" role="button" aria-label="Dismiss"><svg aria-hidden="true" viewbox="0 0 24 24" width="24px" height="24px"><path d="M6.4 19 5 17.6l5.6-5.6L5 6.4 6.4 5l5.6 5.6L17.6 5 19 6.4 13.4 12l5.6 5.6-1.4 1.4-5.6-5.6Z"></path></svg></div></div></td></tr><tr><td style="height: 100%"><iframe id="sandboxFrame" title="Cuestionario Dinámico" allow="accelerometer *; ambient-light-sensor *; autoplay *; camera *; clipboard-read *; clipboard-write *; encrypted-media *; fullscreen *; geolocation *; gyroscope *; magnetometer *; microphone *; midi *; payment *; picture-in-picture *; screen-wake-lock *; speaker *; sync-xhr *; usb *; web-share *; vibrate *; vr *" sandbox="allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation allow-storage-access-by-user-activation" src="./CuestionarioIC2_files/userCodeAppPanel.html">
</iframe>
</td></tr></tbody></table><script nonce="">
(function() {
var el = document.getElementById('sandboxFrame');
el.onload = function() {
goog.script.init("\x7b\x22functionNames\x22:\x5b\x22doGet\x22,\x22include\x22,\x22getTemas\x22,\x22getPreguntas\x22,\x22shuffle\x22\x5d,\x22sandboxMode\x22:\x22IFRAME_SANDBOX\x22,\x22callbackTimeout\x22:390000,\x22deploymentId\x22:\x22AKfycbxsyGVm8ANjGPhqO34QdNXYp7K02O9_iy--42Wjx_ptG9-Xr-hp9MRc0WizQ9bR_aX-8w\x22,\x22eei\x22:\x22\x22,\x22sandboxHost\x22:\x22https:\/\/n-56x2u3kmjlqv34i5yasnr5ddmke75qsmf3itcyy-0lu-script.googleusercontent.com\x22,\x22clientSideProperties\x22:\x7b\x22google.script.sandbox.mode\x22:\x22IFRAME_SANDBOX\x22,\x22google.script.host.origin\x22:\x22https:\/\/docs.google.com\x22\x7d,\x22actionPrefix\x22:\x22\/macros\/s\/AKfycbxsyGVm8ANjGPhqO34QdNXYp7K02O9_iy--42Wjx_ptG9-Xr-hp9MRc0WizQ9bR_aX-8w\x22,\x22userHtml\x22:\x22\x3c!DOCTYPE html\x3e\\n\x3chtml\x3e\\n\x3chead\x3e\\n  \x3cbase target\x3d\\\x22_top\\\x22\x3e\\n  \x3cmeta name\x3d\\\x22viewport\\\x22 content\x3d\\\x22width\x3ddevice-width, initial-scale\x3d1.0\\\x22\x3e\\n  \x3cstyle\x3e\\n     \\n    body \x7b\\n      font-family: Arial, sans-serif;\\n      text-align: center;\\n      margin: 0;\\n      padding: 20px;\\n      background-color: #f4f4f4;\\n    \x7d\\n    .container \x7b\\n      max-width: 900px;\\n      margin: auto;\\n    \x7d\\n    h1 \x7b\\n      color: #333;\\n      font-size: 2.5em;\\n      margin-bottom: 5px;\\n    \x7d\\n    p \x7b\\n      color: #666;\\n      margin-bottom: 30px;\\n    \x7d\\n    .modulo-grid \x7b\\n      display: grid;\\n      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));  \\n      gap: 20px;\\n      margin-top: 40px;\\n    \x7d\\n    .modulo-btn \x7b\\n      padding: 40px 20px;\\n      border-radius: 10px;\\n      color: white;\\n      font-size: 1.2em;\\n      font-weight: bold;\\n      cursor: pointer;\\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\\n      transition: transform 0.2s, opacity 0.2s;\\n    \x7d\\n    .modulo-btn:hover \x7b\\n      transform: translateY(-3px);\\n      opacity: 0.9;\\n    \x7d\\n     \\n    .color-1 \x7b background-color: #1e88e5; \x7d\\n    .color-2 \x7b background-color: #ffb300; \x7d\\n    .color-3 \x7b background-color: #43a047; \x7d\\n    .color-4 \x7b background-color: #e53935; \x7d\\n    .color-5 \x7b background-color: #8e24aa; \x7d\\n    .color-6 \x7b background-color: #37474f; \x7d\\n    \\n     \\n    #cuestionario-view \x7b\\n      display: none;\\n      text-align: left;\\n      background-color: white;\\n      padding: 30px;\\n      border-radius: 8px;\\n      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\\n    \x7d\\n    .pregunta \x7b\\n      margin-bottom: 25px;\\n      border-bottom: 1px solid #eee;\\n      padding-bottom: 15px;\\n    \x7d\\n    .opcion-label \x7b\\n      display: block;\\n      margin: 10px 0;\\n      padding: 10px;\\n      border: 1px solid #ccc;\\n      border-radius: 5px;\\n      cursor: pointer;\\n    \x7d\\n    input\x5btype\x3d\\\x22radio\\\x22\x5d \x7b\\n        margin-right: 10px;\\n    \x7d\\n    .submit-btn \x7b\\n        background-color: #1e88e5;\\n        color: white;\\n        padding: 12px 25px;\\n        border: none;\\n        border-radius: 5px;\\n        font-size: 1.1em;\\n        cursor: pointer;\\n        margin-top: 20px;\\n    \x7d\\n    \\n     \\n    #resultado-view \x7b\\n        display: none;\\n        text-align: left;\\n        padding: 30px;\\n        background-color: #e8f5e9; \\n        border-radius: 8px;\\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\\n    \x7d\\n    .respuesta-correcta \x7b\\n        color: green;\\n        font-weight: bold;\\n    \x7d\\n    .explicacion \x7b\\n        border-left: 3px solid #1e88e5;\\n        padding-left: 10px;\\n        margin-top: 10px;\\n        font-style: italic;\\n        font-size: 0.9em;\\n    \x7d\\n     \\n    @media print \x7b\\n        body \x7b background-color: white; \x7d\\n        .container \x7b max-width: 100%; box-shadow: none; \x7d\\n        .submit-btn, button\x5bonclick\x3d\\\x22location.reload()\\\x22\x5d \x7b display: none !important; \x7d\\n        .pregunta \x7b page-break-inside: avoid; \x7d\\n    \x7d\\n  \x3c\\\/style\x3e\\n\x3c\\\/head\x3e\\n\x3cbody\x3e\\n\x3cdiv class\x3d\\\x22container\\\x22\x3e\\n\\n  \x3cdiv id\x3d\\\x22seleccion-view\\\x22\x3e\\n      \x3ch1\x3ePRÁCTICA\x3c\\\/h1\x3e\\n      \x3cp\x3eSeleccione el módulo técnico a evaluar (10 preguntas aleatorias por intento)\x3c\\\/p\x3e\\n      \\n      \x3cdiv class\x3d\\\x22modulo-grid\\\x22 id\x3d\\\x22modulo-grid\\\x22\x3e\\n          \x3cp id\x3d\\\x22cargando-temas\\\x22\x3eCargando módulos...\x3c\\\/p\x3e\\n      \x3c\\\/div\x3e\\n      \\n      \x3cp style\x3d\\\x22margin-top: 50px;\\\x22\x3eCada intento selecciona 10 preguntas al azar de un banco de 30, asegurando la variabilidad.\x3c\\\/p\x3e\\n  \x3c\\\/div\x3e\\n\\n  \x3cdiv id\x3d\\\x22cuestionario-view\\\x22\x3e\\n      \x3ch2 id\x3d\\\x22titulo-cuestionario\\\x22\x3eCuestionario: Tema X\x3c\\\/h2\x3e\\n      \x3cform id\x3d\\\x22quiz-form\\\x22\x3e\\n          \x3c\\\/form\x3e\\n      \x3cbutton class\x3d\\\x22submit-btn\\\x22 onclick\x3d\\\x22corregirCuestionario()\\\x22\x3eFinalizar y Corregir\x3c\\\/button\x3e\\n  \x3c\\\/div\x3e\\n\\n  \x3cdiv id\x3d\\\x22resultado-view\\\x22\x3e\\n      \x3ch2\x3eResultados de la Práctica\x3c\\\/h2\x3e\\n      \x3cp\x3eTu puntuación es: \x3cspan id\x3d\\\x22puntuacion-final\\\x22\x3e\x3c\\\/span\x3e\x3c\\\/p\x3e\\n      \x3cdiv id\x3d\\\x22respuestas-revisadas\\\x22\x3e\\n          \x3c\\\/div\x3e\\n      \x3cbutton class\x3d\\\x22submit-btn\\\x22 style\x3d\\\x22margin-right: 15px;\\\x22 onclick\x3d\\\x22imprimirCuestionario()\\\x22\x3eGenerar PDF (Imprimir)\x3c\\\/button\x3e\\n      \x3cbutton class\x3d\\\x22submit-btn\\\x22 onclick\x3d\\\x22location.reload()\\\x22\x3eNuevo Intento\x3c\\\/button\x3e\\n  \x3c\\\/div\x3e\\n\\n\\n\x3c\\\/div\x3e\\n\\n\x3cscript\x3e\\n    const colors \x3d \x5b\x27color-1\x27, \x27color-2\x27, \x27color-3\x27, \x27color-4\x27, \x27color-5\x27, \x27color-6\x27, \x27color-1\x27, \x27color-2\x27\x5d;\\n    let preguntasGlobal \x3d \x5b\x5d; \\n    let startTime; \\n    let userName \x3d \x27\x27;\\n    \\n    \\n    function cargarModulos() \x7b\\n        \\n        google.script.run\\n              .withSuccessHandler(generarBotones)\\n              .withFailureHandler(mostrarError)\\n              .getTemas();\\n    \x7d\\n    \\n    function generarBotones(temas) \x7b\\n        const grid \x3d document.getElementById(\x27modulo-grid\x27);\\n        grid.innerHTML \x3d \x27\x27;\\n        \\n        if (temas.length \x3d\x3d\x3d 0) \x7b\\n            grid.innerHTML \x3d \x27\x3cp style\x3d\\\x22color: red;\\\x22\x3eError: No se encontraron temas en la Hoja de Cálculo. Revise el encabezado \\\x22Tema\\\x22 en la columna B.\x3c\\\/p\x3e\x27;\\n            return;\\n        \x7d\\n\\n        temas.forEach((tema, index) \x3d\x3e \x7b\\n            const button \x3d document.createElement(\x27div\x27);\\n            button.className \x3d `modulo-btn $\x7bcolors\x5bindex % colors.length\x5d\x7d`; \\n            button.innerHTML \x3d `$\x7bindex + 1\x7d. $\x7btema\x7d`;\\n            button.onclick \x3d () \x3d\x3e solicitarNombreYIniciar(tema);\\n            grid.appendChild(button);\\n        \x7d);\\n    \x7d\\n\\n    \\n    function solicitarNombreYIniciar(tema) \x7b\\n        const nombre \x3d prompt(\\\x22Por favor, introduce tu nombre para iniciar la práctica:\\\x22);\\n        if (nombre \x26\x26 nombre.trim() !\x3d\x3d \x27\x27) \x7b\\n            userName \x3d nombre.trim();\\n            iniciarCuestionario(tema);\\n        \x7d else \x7b\\n            alert(\\\x22El nombre es requerido para iniciar la sesión.\\\x22);\\n        \x7d\\n    \x7d\\n\\n    \\n    function iniciarCuestionario(tema) \x7b\\n        startTime \x3d Date.now(); \\n        \\n        document.getElementById(\x27seleccion-view\x27).style.display \x3d \x27none\x27;\\n        document.getElementById(\x27cuestionario-view\x27).style.display \x3d \x27block\x27;\\n        document.getElementById(\x27titulo-cuestionario\x27).textContent \x3d `Cuestionario de $\x7btema\x7d ($\x7buserName\x7d)`;\\n        \\n        document.getElementById(\x27quiz-form\x27).innerHTML \x3d \x27\x3cp\x3eCargando 10 preguntas aleatorias...\x3c\\\/p\x3e\x27;\\n\\n        google.script.run\\n              .withSuccessHandler(renderizarCuestionario)\\n              .withFailureHandler(mostrarError)\\n              .getPreguntas(tema); \\n    \x7d\\n    \\n    function renderizarCuestionario(preguntas) \x7b\\n        preguntasGlobal \x3d preguntas; \\n        const form \x3d document.getElementById(\x27quiz-form\x27);\\n        form.innerHTML \x3d \x27\x27;\\n        \\n        if (preguntas.length \x3d\x3d\x3d 0) \x7b\\n            form.innerHTML \x3d \x27\x3cp style\x3d\\\x22color: red;\\\x22\x3eNo se encontraron suficientes preguntas para este tema.\x3c\\\/p\x3e\x27;\\n            return;\\n        \x7d\\n\\n        preguntas.forEach((p, index) \x3d\x3e \x7b\\n            const preguntaDiv \x3d document.createElement(\x27div\x27);\\n            preguntaDiv.className \x3d \x27pregunta\x27;\\n            preguntaDiv.innerHTML \x3d `\x3ch4\x3e$\x7bindex + 1\x7d. $\x7bp.pregunta\x7d\x3c\\\/h4\x3e`;\\n            \\n            \/\/ p.opciones ya viene barajada desde Code.gs\\n            p.opciones.forEach((opcion, opIndex) \x3d\x3e \x7b\\n                \\n                if (opcion \x26\x26 opcion.toString().trim() !\x3d\x3d \x27\x27) \x7b\\n                    const radioId \x3d `q$\x7bindex\x7d-op$\x7bopIndex\x7d`;\\n                    preguntaDiv.innerHTML +\x3d `\\n                        \x3clabel for\x3d\\\x22$\x7bradioId\x7d\\\x22 class\x3d\\\x22opcion-label\\\x22\x3e\\n                            \x3cinput type\x3d\\\x22radio\\\x22 id\x3d\\\x22$\x7bradioId\x7d\\\x22 name\x3d\\\x22pregunta-$\x7bindex\x7d\\\x22 value\x3d\\\x22$\x7bopcion\x7d\\\x22\x3e\\n                            $\x7bopcion\x7d\\n                        \x3c\\\/label\x3e\\n                    `;\\n                \x7d\\n            \x7d);\\n            \\n            form.appendChild(preguntaDiv);\\n        \x7d);\\n    \x7d\\n\\n    \/\/ --- LÓGICA DE CORRECCIÓN Y RESULTADOS ---\\n    function corregirCuestionario() \x7b\\n        const endTime \x3d Date.now();\\n        const duracionSegundos \x3d Math.round((endTime - startTime) \/ 1000);\\n        let aciertos \x3d 0;\\n        const totalPreguntas \x3d preguntasGlobal.length;\\n        const form \x3d document.getElementById(\x27quiz-form\x27);\\n        const resultadosDiv \x3d document.getElementById(\x27respuestas-revisadas\x27);\\n        resultadosDiv.innerHTML \x3d \x27\x27; \\n\\n        \\n        preguntasGlobal.forEach((p, index) \x3d\x3e \x7b\\n            \\n            const respuestaUsuario \x3d form.elements\x5b`pregunta-$\x7bindex\x7d`\x5d ? form.elements\x5b`pregunta-$\x7bindex\x7d`\x5d.value : null;\\n            const esCorrecta \x3d respuestaUsuario \x3d\x3d\x3d p.correcta;\\n            \\n            if (esCorrecta) \x7b\\n                aciertos++;\\n            \x7d\\n\\n            const resultadoHTML \x3d `\\n                \x3cdiv class\x3d\\\x22pregunta\\\x22\x3e\\n                    \x3ch4\x3e$\x7bindex + 1\x7d. $\x7bp.pregunta\x7d\x3c\\\/h4\x3e\\n                    \x3cp\x3e\x3cstrong\x3eTu Respuesta:\x3c\\\/strong\x3e $\x7brespuestaUsuario ? respuestaUsuario : \x27Sin responder\x27\x7d $\x7besCorrecta ? \x27✅\x27 : \x27❌\x27\x7d\x3c\\\/p\x3e\\n                    \x3cp class\x3d\\\x22respuesta-correcta\\\x22\x3e\x3cstrong\x3eRespuesta Correcta:\x3c\\\/strong\x3e $\x7bp.correcta\x7d\x3c\\\/p\x3e\\n                    \x3cdiv class\x3d\\\x22explicacion\\\x22\x3e\\n                        \x3cstrong\x3eExplicación:\x3c\\\/strong\x3e $\x7bp.explicacion\x7d\\n                    \x3c\\\/div\x3e\\n                \x3c\\\/div\x3e\\n            `;\\n            resultadosDiv.innerHTML +\x3d resultadoHTML;\\n        \x7d);\\n\\n        \\n        document.getElementById(\x27puntuacion-final\x27).textContent \x3d `$\x7baciertos\x7d de $\x7btotalPreguntas\x7d (Duración: $\x7bduracionSegundos\x7ds)`;\\n        \\n        document.getElementById(\x27cuestionario-view\x27).style.display \x3d \x27none\x27;\\n        document.getElementById(\x27resultado-view\x27).style.display \x3d \x27block\x27;\\n        \\n        \\n        const temaMatch \x3d document.getElementById(\x27titulo-cuestionario\x27).textContent.match(\/Cuestionario de (.*) \\\\(\/);\\n        const tema \x3d temaMatch ? temaMatch\x5b1\x5d.trim() : \\\x22Desconocido\\\x22;\\n        \\n        const userData \x3d \x7b\\n            nombre: userName,\\n            tema: tema,\\n            aciertos: aciertos,\\n            total: totalPreguntas,\\n            duracion: duracionSegundos\\n        \x7d;\\n        \\n        google.script.run\\n              .withFailureHandler((e) \x3d\x3e console.error(\\\x22Error al registrar uso: \\\x22, e))\\n              .registrarUso(userData);\\n    \x7d\\n    \\n    \\n    function imprimirCuestionario() \x7b\\n        window.print();\\n    \x7d\\n\\n    function mostrarError(error) \x7b\\n        document.getElementById(\x27cargando-temas\x27).innerHTML \x3d `\\n            \x3ch3 style\x3d\\\x22color: red;\\\x22\x3eError al cargar los módulos\x3c\\\/h3\x3e\\n            \x3cp\x3eAsegúrate de haber **autorizado los permisos** después de la última implementación y que la pestaña se llame **\x27Datos\x27**.\x3c\\\/p\x3e\\n            \x3cp\x3eMensaje de error: $\x7berror.message\x7d\x3c\\\/p\x3e\\n        `;\\n        document.getElementById(\x27seleccion-view\x27).style.display \x3d \x27block\x27;\\n        document.getElementById(\x27cuestionario-view\x27).style.display \x3d \x27none\x27;\\n        document.getElementById(\x27resultado-view\x27).style.display \x3d \x27none\x27;\\n    \x7d\\n\\n    window.onload \x3d cargarModulos;\\n\x3c\\\/script\x3e\\n\x3c\\\/body\x3e\\n\x3c\\\/html\x3e\x22,\x22ncc\x22:\x22\x7b\\\x22awhs\\\x22:true\x7d\x22\x7d", "AJuLMu0gVN4xhDBqHYfYdKd7cuGEIDa8eQ:1763994836288", undefined, true , true  , "true", "https:\/\/n-56x2u3kmjlqv34i5yasnr5ddmke75qsmf3itcyy-0lu-script.googleusercontent.com", "");}
el.src = 'https:\/\/n-56x2u3kmjlqv34i5yasnr5ddmke75qsmf3itcyy-0lu-script.googleusercontent.com\/userCodeAppPanel?createOAuthDialog\x3dtrue';
}());
</script>


</body></html>