<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√°ctica Interactiva - Evaluaci√≥n T√©cnica</title>
    <style>
        /* ================= ESTILOS GENERALES ================= */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f9; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 850px; margin: 0 auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        /* Encabezados */
        h1 { text-align: center; color: #2c3e50; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .subtitle { text-align: center; color: #7f8c8d; margin-bottom: 30px; font-weight: 300; }
        .exam-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #3498db; padding-bottom: 15px; margin-bottom: 20px; }
        .tema-badge { background-color: #3498db; color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 0.9em; }

        /* Men√∫ Principal */
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .menu-btn { 
            padding: 30px; font-size: 1.3rem; color: white; border: none; border-radius: 10px; cursor: pointer; 
            transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-weight: bold;
        }
        .btn-acustica { background: linear-gradient(135deg, #3498db, #2980b9); }
        .btn-lumi { background: linear-gradient(135deg, #f1c40f, #e67e22); }
        .menu-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }

        /* Preguntas */
        #seccion-quiz { display: none; }
        .question-block { margin-bottom: 20px; padding: 20px; border: 1px solid #e1e4e8; border-radius: 8px; background-color: #fff; page-break-inside: avoid; }
        .question-title { font-weight: bold; font-size: 1.1em; margin-bottom: 12px; display: block; color: #2c3e50; }
        
        .options label { display: block; padding: 10px; margin-bottom: 5px; cursor: pointer; border-radius: 5px; border: 1px solid transparent; transition: background 0.2s; }
        .options label:hover { background-color: #f8f9fa; border-color: #dee2e6; }
        input[type="radio"] { margin-right: 12px; }

        /* Botones */
        .btn-container { margin-top: 30px; display: flex; gap: 10px; flex-wrap: wrap; }
        .action-btn { flex: 1; padding: 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1rem; color: white; transition: background 0.3s; }
        .btn-evaluar { background-color: #27ae60; } .btn-evaluar:hover { background-color: #219150; }
        .btn-volver { background-color: #7f8c8d; } .btn-volver:hover { background-color: #6c757d; }
        .btn-pdf { background-color: #e74c3c; display: none; } .btn-pdf:hover { background-color: #c0392b; }

        /* Feedback (Explicaciones) */
        .feedback { margin-top: 15px; padding: 15px; border-radius: 6px; font-size: 0.95em; display: none; border-left: 5px solid transparent; }
        .feedback p { margin: 0 0 5px 0; }
        .correct { background-color: #d4edda; color: #155724; border-left-color: #28a745; }
        .incorrect { background-color: #fff3cd; color: #856404; border-left-color: #ffc107; } /* Amarillo alerta para explicaci√≥n */
        .incorrect-label { color: #dc3545; font-weight: bold; }
        
        .explanation-title { font-weight: bold; display: block; margin-bottom: 5px; text-decoration: underline; }

        /* Resultado Final */
        #resultado-final { text-align: center; font-size: 1.4rem; margin-top: 30px; padding: 20px; display: none; border-radius: 8px; font-weight: bold; border: 2px solid #ccc; }

        /* ================= IMPRESI√ìN (PDF) ================= */
        @media print {
            body { background-color: white; padding: 0; font-size: 12pt; }
            .container { box-shadow: none; max-width: 100%; padding: 0; margin: 0; }
            #seccion-menu, .btn-container, .subtitle { display: none !important; }
            #seccion-quiz { display: block !important; }
            h1 { font-size: 18pt; margin-bottom: 10px; }
            
            /* Colores forzados */
            .correct { -webkit-print-color-adjust: exact; print-color-adjust: exact; background-color: #f0fff4 !important; border: 1px solid #ccc; }
            .incorrect { -webkit-print-color-adjust: exact; print-color-adjust: exact; background-color: #fffbf0 !important; border: 1px solid #ccc; }
            #resultado-final { -webkit-print-color-adjust: exact; print-color-adjust: exact; display: block !important; border: 2px solid #000; }
            
            .question-block { border: none; border-bottom: 1px solid #eee; margin-bottom: 15px; padding: 10px 0; }
        }
    </style>
</head>
<body>

<div class="container">
    
    <div id="seccion-menu">
        <h1>Pr√°ctica</h1>
        <p class="subtitle">Seleccione el m√≥dulo t√©cnico a evaluar</p>
        
        <div class="menu-grid">
            <button class="menu-btn btn-acustica" onclick="iniciarExamen('acustica')">
                üîä Ac√∫stica
            </button>
            <button class="menu-btn btn-lumi" onclick="iniciarExamen('luminotecnia')">
                üí° Luminotecnia
            </button>
        </div>
        <p style="text-align: center; margin-top: 40px; color: #999; font-size: 0.9em;">
            El sistema generar√° un examen aleatorio con 10 preguntas y sus respectivas justificaciones t√©cnicas.
        </p>
    </div>

    <div id="seccion-quiz">
        <div class="exam-header">
            <h2 id="titulo-tema" style="margin:0;">Materia</h2>
            <span id="badge-tema" class="tema-badge">TEMA 1</span>
        </div>

        <form id="quizForm">
            <div id="quiz-container"></div>
            
            <div class="btn-container">
                <button type="button" id="btn-eval" class="action-btn btn-evaluar" onclick="verificarRespuestas()">‚úÖ Evaluar y Ver Explicaciones</button>
                <button type="button" id="btn-pdf" class="action-btn btn-pdf" onclick="window.print()">üìÑ Descargar Resultados (PDF)</button>
                <button type="button" id="btn-back" class="action-btn btn-volver" onclick="volverAlMenu()">‚¨Ö Volver al Men√∫</button>
            </div>
        </form>
        
        <div id="resultado-final"></div>
    </div>

</div>

<script>
    /* =========================================================
       BASE DE DATOS CON EXPLICACIONES (exp)
       ========================================================= */
    const bancoPreguntas = {
        acustica: [
            { p: "¬øCu√°l es la definici√≥n f√≠sica del sonido?", ops: ["Onda electromagn√©tica.", "Onda mec√°nica longitudinal.", "Flujo de part√≠culas.", "Onda transversal."], c: 1, exp: "El sonido es una perturbaci√≥n mec√°nica que necesita un medio material (aire, agua, s√≥lido) para propagarse. Es longitudinal porque las part√≠culas vibran en la misma direcci√≥n que la onda." },
            { p: "¬øQu√© cualidad subjetiva determina la frecuencia?", ops: ["Timbre", "Intensidad", "Altura o Tono", "Duraci√≥n"], c: 2, exp: "La frecuencia f√≠sica (Hz) se percibe subjetivamente como la Altura o Tono. A mayor frecuencia, sonido m√°s agudo; a menor frecuencia, m√°s grave." },
            { p: "¬øRango audible promedio del humano?", ops: ["20 Hz - 20 kHz", "0 Hz - 1 kHz", "100 Hz - 10 kHz", "5 Hz - 50 kHz"], c: 0, exp: "El o√≠do humano sano percibe frecuencias entre 20 Hz y 20.000 Hz (20 kHz). Por debajo son infrasonidos y por encima ultrasonidos." },
            { p: "¬øQu√© percibimos al aumentar la amplitud?", ops: ["Tono m√°s agudo", "Mayor volumen", "Mayor velocidad", "Cambio de timbre"], c: 1, exp: "La amplitud de la onda est√° directamente relacionada con la energ√≠a y la presi√≥n sonora, lo cual percibimos como Intensidad o 'Volumen'." },
            { p: "¬øD√≥nde viaja m√°s r√°pido el sonido?", ops: ["Aire", "Agua", "Acero", "Vac√≠o"], c: 2, exp: "El sonido viaja m√°s r√°pido en medios m√°s densos y el√°sticos. En el acero (~5000 m/s) viaja mucho m√°s r√°pido que en agua (~1500 m/s) o aire (~340 m/s)." },
            { p: "¬øUnidad del Nivel de Presi√≥n Sonora?", ops: ["Hz", "Watts", "Pascales", "Decibeles (dB)"], c: 3, exp: "El Decibel (dB) es la unidad logar√≠tmica usada para medir el nivel de presi√≥n sonora, comparando la presi√≥n medida con una presi√≥n de referencia auditiva." },
            { p: "¬øQu√© es la Resonancia?", ops: ["Vibraci√≥n por coincidencia de frecuencia natural.", "Anulaci√≥n de ondas.", "Reflexi√≥n del sonido.", "Cambio de tono por movimiento."], c: 0, exp: "La resonancia ocurre cuando una fuerza externa impulsa a un sistema a oscilar a su frecuencia natural, aumentando dr√°sticamente la amplitud." },
            { p: "¬øDiferencia clave entre Eco y Reverberaci√≥n?", ops: ["El tipo de superficie.", "La frecuencia.", "El tiempo de retardo (>0.1s).", "No hay diferencia."], c: 2, exp: "F√≠sicamente es el mismo fen√≥meno (reflexi√≥n), pero si el retardo es mayor a ~0.1s (aprox 17m), el o√≠do distingue dos sonidos separados (Eco). Si es menor, se suman (Reverberaci√≥n)." },
            { p: "¬øQu√© distingue la misma nota en distintos instrumentos?", ops: ["Frecuencia", "Intensidad", "Longitud de onda", "Timbre"], c: 3, exp: "El timbre depende de la composici√≥n de arm√≥nicos de la onda. Aunque la frecuencia fundamental sea la misma (la misma nota), los arm√≥nicos hacen que suenen distinto." },
            { p: "¬øEfecto Doppler al acercarse la fuente?", ops: ["Sonido m√°s grave", "Sonido m√°s agudo", "Menos volumen", "Mayor velocidad"], c: 1, exp: "Al acercarse la fuente, las ondas se 'comprimen' frente a ella, llegando con mayor frecuencia al observador, percibi√©ndose m√°s agudo." },
            { p: "¬øCu√°l es el umbral de dolor auditivo aproximado?", ops: ["60 dB", "90 dB", "120-140 dB", "200 dB"], c: 2, exp: "Alrededor de los 120-130 dB la sensaci√≥n auditiva comienza a convertirse en dolor f√≠sico y da√±o inmediato." },
            { p: "¬øPuede el sonido viajar en el vac√≠o?", ops: ["S√≠, a baja velocidad.", "No, necesita un medio material.", "S√≠, si es alta frecuencia.", "Depende de la temperatura."], c: 1, exp: "El sonido es una onda mec√°nica, lo que significa que requiere vibraci√≥n de materia (√°tomos/mol√©culas). En el vac√≠o no hay nada que vibre." },
            { p: "¬øQu√© es un Infrasonido?", ops: ["Sonido muy fuerte.", "Frecuencia superior a 20.000 Hz.", "Frecuencia inferior a 20 Hz.", "Sonido dentro del agua."], c: 2, exp: "Los infrasonidos son frecuencias por debajo del umbral de audici√≥n humano (menos de 20 Hz), producidos por sismos, elefantes, etc." },
            { p: "¬øQu√© es un Ultrasonido?", ops: ["Frecuencia superior a 20.000 Hz.", "Frecuencia inferior a 20 Hz.", "Sonido digital.", "Ruido blanco."], c: 0, exp: "Frecuencias por encima del l√≠mite humano superior (20 kHz). Usados en ecograf√≠as y sonares." },
            { p: "¬øQu√© material es mejor aislante ac√∫stico?", ops: ["Vidrio simple", "Hormig√≥n armado", "Lana de roca/vidrio", "Metal"], c: 2, exp: "Los materiales porosos y fibrosos como la lana de vidrio atrapan el aire y disipan la energ√≠a sonora por fricci√≥n, siendo excelentes absorbentes/aislantes." },
            { p: "¬øC√≥mo se llama el tiempo que tarda una onda en completar un ciclo?", ops: ["Frecuencia", "Periodo", "Amplitud", "Longitud"], c: 1, exp: "El Periodo (T) es el tiempo en segundos que dura un ciclo completo. Es el inverso de la frecuencia (T = 1/f)." },
            { p: "¬øLa velocidad del sonido en el aire depende principalmente de...?", ops: ["La frecuencia.", "La intensidad.", "La temperatura del aire.", "El volumen de la fuente."], c: 2, exp: "La velocidad var√≠a con la temperatura: aumenta aprox. 0.6 m/s por cada grado Celsius que sube la temperatura." },
            { p: "¬øQu√© es la longitud de onda?", ops: ["La altura de la onda.", "Distancia entre dos crestas consecutivas.", "N√∫mero de ciclos por segundo.", "El tiempo de vibraci√≥n."], c: 1, exp: "Es la distancia f√≠sica que recorre la onda en un ciclo completo. Se representa con la letra griega lambda (Œª)." },
            { p: "¬øA qu√© frecuencia vibra la nota La (A4) est√°ndar?", ops: ["256 Hz", "432 Hz", "440 Hz", "1000 Hz"], c: 2, exp: "El est√°ndar internacional de afinaci√≥n ISO 16 fija la nota La4 en 440 Hz." },
            { p: "¬øQu√© parte del o√≠do convierte la vibraci√≥n en impulsos nerviosos?", ops: ["T√≠mpano", "Martillo", "C√≥clea (Caracol)", "Pabell√≥n auricular"], c: 2, exp: "La c√≥clea contiene las c√©lulas ciliadas que transforman la energ√≠a mec√°nica de la vibraci√≥n en se√±ales el√©ctricas para el cerebro." },
            { p: "¬øQu√© sucede con el sonido al pasar del aire al agua?", ops: ["Aumenta su velocidad.", "Disminuye su velocidad.", "Mantiene su velocidad.", "Se detiene."], c: 0, exp: "Al pasar a un medio m√°s denso como el agua, el sonido acelera dr√°sticamente (de 340 m/s a 1500 m/s aprox)." },
            { p: "¬øQu√© es el ruido rosa?", ops: ["Un sonido agudo.", "Ruido con igual energ√≠a por octava.", "Ausencia de sonido.", "Un tono puro."], c: 1, exp: "El ruido rosa se utiliza para calibraci√≥n ac√∫stica porque tiene la misma energ√≠a en cada octava, asemej√°ndose m√°s a c√≥mo oye el humano." },
            { p: "Si duplicamos la distancia a la fuente, la intensidad...", ops: ["Se duplica.", "Se reduce a la mitad.", "Se reduce a la cuarta parte.", "No cambia."], c: 2, exp: "Ley de la Inversa del Cuadrado: La intensidad decae con el cuadrado de la distancia (1/2¬≤ = 1/4)." },
            { p: "¬øQu√© es la difracci√≥n del sonido?", ops: ["Rebote en una pared.", "Capacidad de rodear obst√°culos.", "Absorci√≥n por materiales.", "Cambio de frecuencia."], c: 1, exp: "La difracci√≥n es la propiedad de las ondas de curvarse para rodear obst√°culos o pasar por rendijas, especialmente si la longitud de onda es comparable al obst√°culo." },
            { p: "Un sonido de 10 Hz es...", ops: ["Audible y agudo.", "Audible y grave.", "Ultras√≥nico.", "Infras√≥nico (no audible)."], c: 3, exp: "Al ser menor a 20 Hz, est√° fuera del rango de percepci√≥n humana y se clasifica como infrasonido." },
            { p: "¬øQu√© magnitud se mide en Hertz?", ops: ["Intensidad", "Potencia", "Frecuencia", "Presi√≥n"], c: 2, exp: "El Hertz (Hz) mide ciclos por segundo, que es la definici√≥n de Frecuencia." },
            { p: "¬øEl 'Volumen' que movemos en la radio modifica...?", ops: ["La Frecuencia.", "La Amplitud.", "La Longitud de Onda.", "El Periodo."], c: 1, exp: "Subir el volumen significa aumentar la potencia de salida, lo que incrementa la Amplitud de la onda sonora." },
            { p: "¬øQu√© es la contaminaci√≥n ac√∫stica?", ops: ["Ruido excesivo que afecta la salud.", "M√∫sica a bajo volumen.", "Uso de auriculares.", "Grabar audio."], c: 0, exp: "Se define como el exceso de sonido que altera las condiciones normales del ambiente y puede causar da√±os fisiol√≥gicos o psicol√≥gicos." },
            { p: "¬øEl sonido es una onda...?", ops: ["Bidimensional.", "Unidimensional.", "Tridimensional (esf√©rica).", "Cuatridimensional."], c: 2, exp: "En un medio abierto, el sonido se propaga en todas las direcciones del espacio, formando frentes de onda esf√©ricos (3D)." },
            { p: "¬øQu√© instrumento mide el nivel sonoro?", ops: ["Lux√≥metro", "Son√≥metro", "Mult√≠metro", "Bar√≥metro"], c: 1, exp: "El son√≥metro es el instrumento dise√±ado para medir niveles de presi√≥n sonora de forma objetiva, generalmente en decibeles." }
        ],
        luminotecnia: [
            { p: "Unidad del Flujo Luminoso", ops: ["Lux", "Candela", "Lumen", "Watt"], c: 2, exp: "El Lumen (lm) mide la cantidad total de luz visible emitida por una fuente. Lux es para luz recibida, Candela para intensidad en una direcci√≥n." },
            { p: "¬øQu√© medimos en Lux?", ops: ["Iluminancia (luz que llega).", "Luminancia (brillo).", "Flujo total.", "Potencia."], c: 0, exp: "El Lux mide la Iluminancia: cu√°ntos l√∫menes caen sobre un metro cuadrado de superficie." },
            { p: "¬øQu√© es la Eficacia Luminosa?", ops: ["Vida √∫til.", "Relaci√≥n L√∫menes por Watt (lm/W).", "Calidad de color.", "Calor emitido."], c: 1, exp: "Indica qu√© tan eficiente es la l√°mpara convirtiendo electricidad en luz. A mayor lm/W, m√°s ahorro de energ√≠a." },
            { p: "Ley inversa del cuadrado: Doble distancia implica...", ops: ["1/2 de luz.", "1/4 de luz.", "Misma luz.", "Doble luz."], c: 1, exp: "La luz se dispersa en un √°rea mayor. Si la distancia es x2, la iluminaci√≥n es 1/(2¬≤) = 1/4." },
            { p: "¬øQu√© define luz c√°lida o fr√≠a?", ops: ["CRI", "Frecuencia", "Temperatura de Color (K)", "Voltaje"], c: 2, exp: "La Temperatura de Color correlacionada, medida en Kelvin, define el tono: ~3000K es c√°lida (amarilla), ~6000K es fr√≠a (azulada)." },
            { p: "¬øTecnolog√≠a basada en semiconductores?", ops: ["Incandescente", "Hal√≥gena", "Fluorescente", "LED"], c: 3, exp: "LED significa Diodo Emisor de Luz. Es un componente electr√≥nico semiconductor que emite fotones al pasar corriente." },
            { p: "¬øQu√© es el CRI o IRC?", ops: ["Ahorro energ√©tico.", "Fidelidad en reproducci√≥n de colores.", "Tono de luz.", "Intensidad."], c: 1, exp: "El √çndice de Reproducci√≥n Crom√°tica (0-100) mide qu√© tan fieles se ven los colores bajo esa luz comparado con la luz natural." },
            { p: "Diferencia Iluminancia vs Luminancia", ops: ["Iluminancia incide, Luminancia es brillo percibido.", "Son iguales.", "Luminancia es calor.", "Iluminancia es flujo."], c: 0, exp: "Iluminancia es la luz que 'cae' en la mesa. Luminancia es la luz que 'sale' de la mesa hacia tu ojo (lo que ves como brillo)." },
            { p: "¬øQu√© es el deslumbramiento?", ops: ["Poca luz.", "Brillo excesivo molesto.", "Parpadeo.", "Sombra."], c: 1, exp: "Es una condici√≥n visual molesta causada por una luminancia excesiva o contrastes extremos que reducen la visibilidad." },
            { p: "Eficiencia aprox. de incandescente", ops: ["90%", "50%", "<10% (resto calor)", "100%"], c: 2, exp: "Las bombillas viejas desperdician m√°s del 90% de la energ√≠a como calor (infrarrojo), por eso fueron prohibidas en muchos lugares." },
            { p: "¬øQu√© instrumento mide la iluminancia?", ops: ["Son√≥metro", "Lux√≥metro", "Amper√≠metro", "Term√≥metro"], c: 1, exp: "El lux√≥metro posee un sensor calibrado para medir la luz incidente en una superficie seg√∫n la sensibilidad del ojo humano." },
            { p: "¬øQu√© temperatura de color es luz d√≠a (neutra/fr√≠a)?", ops: ["2700 K", "3000 K", "5500 K - 6500 K", "1000 K"], c: 2, exp: "La luz del sol al mediod√≠a ronda los 5500K-6500K. Los valores bajos (3000K) son luces amarillentas tipo atardecer." },
            { p: "¬øQu√© significa que una l√°mpara sea 'omnidireccional'?", ops: ["Emite luz hacia abajo.", "Emite luz en todas direcciones.", "Es un l√°ser.", "Solo ilumina techos."], c: 1, exp: "Omni significa 'todo'. Emite luz en 360 grados (o casi), ideal para iluminaci√≥n general." },
            { p: "¬øCu√°l es la unidad de Intensidad Luminosa?", ops: ["Lumen", "Lux", "Candela", "Joule"], c: 2, exp: "La Candela (cd) es la unidad base del SI. Mide la 'fuerza' de la luz en una direcci√≥n espec√≠fica." },
            { p: "¬øQu√© tipo de l√°mpara usa vapor de mercurio?", ops: ["Descarga", "Incandescente", "LED", "Hal√≥gena"], c: 0, exp: "Las l√°mparas de descarga generan luz mediante un arco el√©ctrico a trav√©s de un gas (mercurio, sodio, etc.)." },
            { p: "El espectro visible va aprox. de...", ops: ["10nm a 100nm", "380nm a 780nm", "1mm a 1m", "1000nm a 2000nm"], c: 1, exp: "El ojo humano solo detecta longitudes de onda electromagn√©tica entre ~380nm (violeta) y ~780nm (rojo)." },
            { p: "¬øQu√© es la vida √∫til de una l√°mpara?", ops: ["Hasta que se rompe el vidrio.", "Tiempo hasta que el flujo cae a un % (ej 70%).", "Tiempo total enchufada.", "Garant√≠a de f√°brica."], c: 1, exp: "En LED, no suelen fundirse de golpe. La vida √∫til (L70) es el tiempo hasta que la luz emitida baja al 70% de la original." },
            { p: "¬øQu√© es un driver en iluminaci√≥n LED?", ops: ["El disipador de calor.", "El chip que da luz.", "La fuente de alimentaci√≥n electr√≥nica.", "El casquillo."], c: 2, exp: "Los LEDs funcionan con corriente continua y bajo voltaje. El driver convierte la corriente alterna de la red (220V/110V) a lo que necesita el chip." },
            { p: "Si una superficie es negra, ¬øqu√© hace con la luz?", ops: ["La refleja toda.", "La absorbe casi toda.", "La transmite.", "La amplifica."], c: 1, exp: "El color negro se define f√≠sicamente por la absorci√≥n de casi todo el espectro visible, reflejando muy poco al ojo." },
            { p: "La reflexi√≥n especular ocurre en...", ops: ["Superficies rugosas.", "Superficies pulidas (espejos).", "Superficies negras.", "El aire."], c: 1, exp: "Ocurre en superficies lisas donde el √°ngulo de incidencia es igual al de reflexi√≥n, creando una imagen n√≠tida (espejo)." },
            { p: "¬øQu√© l√°mpara tarda m√°s en encender al 100%?", ops: ["LED", "Hal√≥gena", "Descarga (Mercurio/Sodio)", "Incandescente"], c: 2, exp: "Las l√°mparas de descarga de alta intensidad requieren calentar los gases internos, tardando varios minutos en dar toda su luz." },
            { p: "¬øQu√© es la contaminaci√≥n lum√≠nica?", ops: ["Luz que emite calor.", "Luz artificial innecesaria hacia el cielo.", "Uso de LEDs baratos.", "Falta de luz en calles."], c: 1, exp: "Es la emisi√≥n de flujo luminoso de fuentes artificiales nocturnas en intensidades, direcciones o rangos espectrales innecesarios, ocultando las estrellas." },
            { p: "¬øQu√© luz atrae menos insectos?", ops: ["UV (Ultravioleta)", "Azul intensa", "C√°lida/Amarilla (Sodio)", "Blanca fr√≠a"], c: 2, exp: "Los insectos son muy sensibles al UV y al azul. Las luces amarillas/√°mbar (espectro c√°lido) son menos visibles para ellos." },
            { p: "Para leer en un escritorio se recomiendan aprox...", ops: ["50 Lux", "100 Lux", "500 Lux", "5000 Lux"], c: 2, exp: "Seg√∫n normativas ergon√≥micas, 500 Lux es el est√°ndar para tareas de lectura y escritura en oficinas." },
            { p: "¬øUn dimmer sirve para...?", ops: ["Cambiar el color.", "Regular la intensidad luminosa.", "Encender m√°s r√°pido.", "Medir el consumo."], c: 1, exp: "Un dimmer o atenuador recorta la onda el√©ctrica para variar la cantidad de luz que emite la l√°mpara." },
            { p: "¬øQu√© es el flujo luminoso √∫til?", ops: ["Todo lo que sale de la l√°mpara.", "El que realmente llega a donde queremos iluminar.", "El que se pierde.", "El calor generado."], c: 1, exp: "En focos direccionales, es el flujo que cae dentro de un cono (ej 90¬∞), descartando la luz que se desperdicia hacia los lados." },
            { p: "El √°ngulo de apertura indica...", ops: ["La temperatura.", "Cu√°n concentrado o abierto es el haz de luz.", "La inclinaci√≥n de la l√°mpara.", "El voltaje."], c: 1, exp: "Tambi√©n llamado 'Beam Angle', define qu√© tan ancho es el cono de luz. Un √°ngulo bajo (10¬∞) es un punto focal; alto (120¬∞) es luz general." },
            { p: "¬øQu√© luz tiene mayor componente azul?", ops: ["Luz de vela.", "Incandescente.", "Luz fr√≠a (6500K).", "Sodio baja presi√≥n."], c: 2, exp: "Las temperaturas de color altas (fr√≠as) tienen un espectro con pico en el azul, similar a la luz del cielo diurno." },
            { p: "¬øLa luz se comporta como...?", ops: ["Solo part√≠cula.", "Solo onda.", "Onda y part√≠cula (dualidad).", "Fluido."], c: 2, exp: "La luz tiene dualidad onda-corp√∫sculo: se propaga como onda electromagn√©tica pero interact√∫a con la materia como paquetes de energ√≠a (fotones)." },
            { p: "El RGB se compone de...", ops: ["Rojo, Amarillo, Azul", "Rojo, Verde, Azul", "Cian, Magenta, Amarillo", "Blanco, Negro, Gris"], c: 1, exp: "RGB (Red, Green, Blue) es el sistema de mezcla aditiva de luz. Sumando los tres se obtiene blanco." }
        ]
    };

    /* ================= L√ìGICA DEL SISTEMA ================= */
    let preguntasExamen = [];

    function mezclar(array) {
        let copia = [...array];
        for (let i = copia.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [copia[i], copia[j]] = [copia[j], copia[i]];
        }
        return copia;
    }

    function iniciarExamen(tema) {
        document.getElementById('seccion-menu').style.display = 'none';
        document.getElementById('seccion-quiz').style.display = 'block';
        document.getElementById('resultado-final').style.display = 'none';
        
        // Botones
        document.getElementById('btn-eval').style.display = 'inline-block';
        document.getElementById('btn-pdf').style.display = 'none';
        
        // Tema y T√≠tulo
        const numTema = Math.floor(Math.random() * 3) + 1;
        document.getElementById('badge-tema').innerText = `TEMA ${numTema}`;
        document.getElementById('badge-tema').style.backgroundColor = tema === 'acustica' ? '#3498db' : '#e67e22';
        
        const titulos = { acustica: "Pr√°ctica de Ac√∫stica", luminotecnia: "Pr√°ctica de Luminotecnia" };
        document.getElementById('titulo-tema').innerText = titulos[tema];

        // Selecci√≥n de preguntas
        const todasLasPreguntas = mezclar(bancoPreguntas[tema]);
        preguntasExamen = todasLasPreguntas.slice(0, 10);

        // Renderizado
        const contenedor = document.getElementById('quiz-container');
        contenedor.innerHTML = "";

        preguntasExamen.forEach((item, index) => {
            let bloque = document.createElement('div');
            bloque.className = "question-block";
            
            let titulo = document.createElement('span');
            titulo.className = "question-title";
            titulo.innerText = `${index + 1}. ${item.p}`;
            bloque.appendChild(titulo);

            let divOpciones = document.createElement('div');
            divOpciones.className = "options";

            item.ops.forEach((opcion, i) => {
                let label = document.createElement('label');
                label.innerHTML = `<input type="radio" name="p${index}" value="${i}"> ${opcion}`;
                divOpciones.appendChild(label);
            });
            bloque.appendChild(divOpciones);

            // Div de Explicaci√≥n (Oculto al principio)
            let feedback = document.createElement('div');
            feedback.id = `feedback-${index}`;
            feedback.className = "feedback";
            bloque.appendChild(feedback);

            contenedor.appendChild(bloque);
        });
        window.scrollTo(0, 0);
    }

    function verificarRespuestas() {
        let puntaje = 0;
        let total = preguntasExamen.length;

        preguntasExamen.forEach((item, index) => {
            const opciones = document.getElementsByName(`p${index}`);
            const feedbackDiv = document.getElementById(`feedback-${index}`);
            let seleccionado = null;

            for (let radio of opciones) {
                if (radio.checked) seleccionado = parseInt(radio.value);
                radio.disabled = true;
            }

            // Generar HTML de la explicaci√≥n
            let htmlFeedback = "";
            
            if (seleccionado === item.c) {
                puntaje++;
                feedbackDiv.className = "feedback correct";
                htmlFeedback += `<p><strong>‚úÖ ¬°Correcto!</strong></p>`;
            } else {
                feedbackDiv.className = "feedback incorrect";
                let respDada = seleccionado !== null ? item.ops[seleccionado] : "Ninguna";
                let respCorrecta = item.ops[item.c];
                htmlFeedback += `<p class="incorrect-label">‚ùå Incorrecto</p>`;
                htmlFeedback += `<p>Respuesta correcta: <strong>${respCorrecta}</strong></p>`;
            }
            
            // AGREGAR LA EXPLICACI√ìN T√âCNICA SIEMPRE (Did√°ctico)
            htmlFeedback += `<hr style="border: 0; border-top: 1px solid rgba(0,0,0,0.1); margin: 10px 0;">`;
            htmlFeedback += `<span class="explanation-title">Justificaci√≥n:</span>`;
            htmlFeedback += `<span>${item.exp}</span>`;

            feedbackDiv.innerHTML = htmlFeedback;
            feedbackDiv.style.display = "block";
        });

        // Nota Final
        const divFinal = document.getElementById('resultado-final');
        let porcentaje = Math.round((puntaje / total) * 100);
        
        divFinal.innerText = `Calificaci√≥n Final: ${puntaje} / ${total} (${porcentaje}%)`;
        
        if(puntaje >= 6) {
            divFinal.style.backgroundColor = "#d4edda";
            divFinal.style.color = "#155724";
            divFinal.style.borderColor = "#c3e6cb";
        } else {
            divFinal.style.backgroundColor = "#fff3cd"; // Amarillo suave para no ser tan agresivo
            divFinal.style.color = "#856404";
            divFinal.style.borderColor = "#ffeeba";
        }
        divFinal.style.display = "block";

        document.getElementById('btn-eval').style.display = 'none';
        document.getElementById('btn-pdf').style.display = 'inline-block';
        
        divFinal.scrollIntoView({ behavior: 'smooth' });
    }

    function volverAlMenu() {
        if(confirm("¬øSalir al men√∫ principal? Se perder√° el examen actual.")) {
            document.getElementById('seccion-quiz').style.display = 'none';
            document.getElementById('seccion-menu').style.display = 'block';
        }
    }
</script>

</body>
</html>
